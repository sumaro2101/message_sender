import{b as v}from"./chunk-W5RPWA2M.js";import{a as u}from"./chunk-65OJRBX6.js";var S='.dj-calendar{--dummy-style: none}.dj-calendar [hidden]{display:none !important}.dj-calendar .controls{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #d3d3d3}.dj-calendar .controls button{display:inline-flex;background-color:rgba(0,0,0,0);border:none;padding:0;min-width:28px}.dj-calendar .controls button.extend{flex-grow:1}.dj-calendar .controls button:hover{background-color:#e0ecf4}.dj-calendar .controls button>svg{margin:0 auto}.dj-calendar .controls time{width:10rem;text-align:center}.dj-calendar .controls.years-view time{opacity:.75}.dj-calendar .sheet-body{display:flex;flex-direction:row;padding:0}.dj-calendar .sheet-body .central{flex-grow:1}.dj-calendar .sheet-body :is(.aside-left,.aside-right){flex-grow:0;font-weight:bold;font-size:small;width:24px}.dj-calendar .sheet-body :is(.aside-left,.aside-right) time{white-space:nowrap;display:inline-block;line-height:24px}.dj-calendar .sheet-body .aside-left:has(>time:not(:empty)){background-color:#0d6efd}.dj-calendar .sheet-body .aside-left>time:not(:empty){color:#fff;transform:rotate(-90deg) translate(-140px, 24px);transform-origin:bottom left}.dj-calendar .sheet-body .aside-right:has(>time:not(:empty)){background-color:#0d6efd}.dj-calendar .sheet-body .aside-right>time:not(:empty){color:#fff;transform:rotate(90deg) translate(30px, -24px);transform-origin:top left}.dj-calendar .sheet-body ul{list-style:none;margin:0;padding:0;text-align:center;display:grid;gap:2px;line-height:38px}.dj-calendar .sheet-body ul:not(*){background-color:#b9f6ff}.dj-calendar .sheet-body ul>li::selection{background-color:rgba(0,0,0,0)}.dj-calendar .sheet-body ul>li.preselected{outline:2px solid #0d6efd}.dj-calendar .sheet-body ul.hours{grid-template-columns:repeat(6, 1fr);margin-bottom:2px}.dj-calendar .sheet-body ul.hours>li.constricted{border:2px solid #d3d3d3;border-bottom-color:#fff;border-bottom-width:2px;border-top-left-radius:5px;border-top-right-radius:5px}.dj-calendar .sheet-body ul.hours>li:has(~li.constricted){border-bottom:2px solid #d3d3d3}.dj-calendar .sheet-body ul.hours>li.constricted~li{border-bottom:2px solid #d3d3d3}.dj-calendar .sheet-body ul.minutes{font-size:smaller;border:2px solid #d3d3d3;margin:-4px 0 4px;padding:0;line-height:inherit}.dj-calendar .sheet-body ul.minutes>li{width:inherit}.dj-calendar .sheet-body ul.minutes>li.preselected{background-color:#e0ecf4}.dj-calendar .sheet-body ul.monthdays{grid-template-columns:repeat(7, 1fr)}.dj-calendar .sheet-body ul.monthdays>li.adjacent{color:#606060}.dj-calendar .sheet-body ul.months{grid-template-columns:repeat(3, 1fr)}.dj-calendar .sheet-body ul.years{grid-template-columns:repeat(4, 1fr)}.dj-calendar .sheet-body ul.weekdays{grid-template-columns:repeat(7, 1fr);font-weight:bold}.dj-calendar .sheet-body ul:not(.weekdays){--dummy-style: none}.dj-calendar .sheet-body ul:not(.weekdays)>li{cursor:pointer}.dj-calendar .sheet-body ul:not(.weekdays)>li.selected{background-color:#0d6efd;color:#fff}.dj-calendar .sheet-body ul:not(.weekdays)>li.selected.today::after{border-color:rgba(0,0,0,0) rgba(0,0,0,0) #fff rgba(0,0,0,0)}.dj-calendar .sheet-body ul:not(.weekdays)>li[disabled]{opacity:.5}.dj-calendar .sheet-body ul:not(.weekdays)>li:not([disabled]):hover{opacity:1;background-color:#e0ecf4 !important}.dj-calendar .sheet-body ul>li.today{position:relative}.dj-calendar .sheet-body ul>li.today::after{position:absolute;content:"";bottom:0;right:0;border-style:solid;border-width:0 0 10px 10px;border-color:rgba(0,0,0,0) rgba(0,0,0,0) #0d6efd rgba(0,0,0,0)}.dj-calendar .sheet-body abbr[title]{text-decoration:none}[aria-haspopup=dialog]+.dj-calendar{box-shadow:#d3d3d3 0 0 1rem;width:max-content;position:absolute;top:0;left:0}[aria-expanded=false]+.dj-calendar{display:none}[aria-expanded=true]+.dj-calendar{display:block}';var M=`<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
	<path d="M15.0713 4.92871L16.4856 6.34292L11.8287 10.9998L21.0006 10.9999L21.0005 12.9999L11.8287 12.9998L16.4856 17.6566L15.0714 19.0708L8.00028 11.9998L15.0713 4.92871ZM4.00049 18.9997L4.00049 4.99972H6.00049L6.00049 18.9997H4.00049Z" />
</svg>`;var R=`<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
	<path d="M12.1714 10.9998L7.51451 6.34292L8.92872 4.92871L15.9998 11.9998L8.92872 19.0708L7.51451 17.6566L12.1713 12.9998L2.99953 12.9999L2.99951 10.9999L12.1714 10.9998ZM17.9996 18.9997L17.9996 4.99972H19.9996L19.9996 18.9997H17.9996Z"></path>
</svg>`;var b=class extends v{constructor(t,e){super(e.inputElement);this.upperRange=!1;this.preselectedDate=null;this.dateRange=[null,null];this.baseSelector=".dj-calendar";this.turnPrev=()=>{this.fetchCalendar(this.prevSheetDate,this.viewMode)};this.turnNext=()=>{this.fetchCalendar(this.nextSheetDate,this.viewMode)};this.turnNarrow=()=>{this.narrowSheetDate&&(this.viewMode==="m"?this.fetchCalendar(this.narrowSheetDate,"w"):this.viewMode==="y"?this.fetchCalendar(this.narrowSheetDate,"m"):this.fetchCalendar(this.narrowSheetDate,this.viewMode))};this.turnExtend=()=>{this.extendSheetDate&&(this.viewMode==="h"?this.fetchCalendar(this.extendSheetDate,"w"):this.viewMode==="w"?this.fetchCalendar(this.extendSheetDate,"m"):this.fetchCalendar(this.extendSheetDate,"y"))};this.turnToday=()=>{this.settings.dateOnly?this.selectToday():this.fetchCalendar(new Date,"h")};this.handleOver=t=>{if(t.target instanceof HTMLLIElement&&this.dateRange[0]&&!this.dateRange[1]){let e=t.target.getAttribute("data-date")??t.target.getAttribute("aria-label")??"",a=new Date(e);this.markDateRange(this.dateRange[0],a,!0),a.getTime()>this.dateRange[0].getTime()?this.rangeSelectCssRule.style.cursor=this.contractRightCursor:this.rangeSelectCssRule.style.cursor=this.contractLeftCursor}};this.selectDay=t=>{t.target instanceof HTMLLIElement&&(this.settings.dateOnly?(this.setDate(t.target),this.markSelectedDates(),(!this.settings.withRange||this.dateRange[0]&&this.dateRange[1])&&this.settings.close()):this.fetchCalendar(this.getDate(t.target),"h"))};this.selectMonth=t=>{t.target instanceof HTMLLIElement&&this.fetchCalendar(this.getDate(t.target),"w")};this.selectYear=t=>{t.target instanceof HTMLLIElement&&this.fetchCalendar(this.getDate(t.target),"m")};this.settings=e,t instanceof HTMLElement?this.element=t:(this.element=document.createElement("div"),this.fetchCalendar(new Date,"w")),new MutationObserver(()=>this.registerCalendar()).observe(this.element,{childList:!0}),this.setInterval(),this.setMinMaxBounds(),u.stylesAreInstalled(this.baseSelector)||this.transferStyles(),this.rangeSelectCssRule=this.getRangeSelectCssRule(),this.rangeSelectorText=this.rangeSelectCssRule.selectorText,this.registerCalendar(),this.sheetBounds=this.getSheetBounds(),this.contractLeftCursor=`url('data:image/svg+xml;utf8,${M.replace(/[\n\t]/g,"")}') 9 9, pointer`,this.contractRightCursor=`url('data:image/svg+xml;utf8,${R.replace(/[\n\t]/g,"")}') 9 9, pointer`}get todayDateString(){return this.asUTCDate(new Date).toISOString().slice(0,this.settings.dateOnly?10:16)}asUTCDate(t){return new Date(t.getTime()-t.getTimezoneOffset()*6e4)}getViewMode(){var e;switch((e=this.element.querySelector(":scope > [aria-label]"))==null?void 0:e.getAttribute("aria-label")){case"hours-view":return"h";case"weeks-view":return"w";case"months-view":return"m";case"years-view":return"y";default:throw new Error(`Unknown aria-label on ${this.element}`)}}setInterval(){let t=this.settings.inputElement.getAttribute("step");if(t){let e=new Date("1970-01-01 0:00:00"),a=new Date(`1970-01-01 ${t}`);this.interval=(a.getTime()-e.getTime())/6e4}}setMinMaxBounds(){let t=this.settings.inputElement.getAttribute("min");if(t){let a=new Date(t);this.minDate=new Date(a.getTime()-a.getTimezoneOffset()*6e4),this.minWeekDate=new Date(this.minDate),this.minWeekDate.setHours(0,0,0),this.minMonthDate=new Date(this.minWeekDate),this.minMonthDate.setDate(1),this.minYearDate=new Date(this.minMonthDate),this.minYearDate.setMonth(0)}let e=this.settings.inputElement.getAttribute("max");if(e){let a=new Date(e);this.maxDate=new Date(a.getTime()-a.getTimezoneOffset()*6e4),this.maxWeekDate=new Date(this.maxDate),this.maxWeekDate.setHours(23,59,59),this.maxMonthDate=new Date(this.maxWeekDate),this.maxMonthDate.setDate(28),this.maxYearDate=new Date(this.maxMonthDate),this.maxYearDate.setMonth(11)}}getDate(t){let e=t instanceof Element?t:this.element.querySelector(t);if(!(e instanceof Element))throw new Error(`Element ${t} is missing`);let a=e.getAttribute("data-date")??e.getAttribute("datetime");return new Date(a??"")}registerCalendar(){var s,n,i,r,l;this.viewMode=this.getViewMode(),this.prevSheetDate=this.getDate("button.prev");let t=this.element.querySelector("button.narrow");this.narrowSheetDate=t?this.getDate(t):void 0,this.nextSheetDate=this.getDate("button.next");let e=this.element.querySelector("button.extend");switch(this.extendSheetDate=e?this.getDate(e):void 0,(s=this.element.querySelector("button.prev"))==null||s.addEventListener("click",this.turnPrev,{once:!0}),(n=this.element.querySelector("button.narrow"))==null||n.addEventListener("click",this.turnNarrow,{once:!0}),(i=this.element.querySelector("button.extend"))==null||i.addEventListener("click",this.turnExtend,{once:!0}),(r=this.element.querySelector("button.today"))==null||r.addEventListener("click",this.turnToday,{once:!0}),(l=this.element.querySelector("button.next"))==null||l.addEventListener("click",this.turnNext,{once:!0}),this.calendarItems=this.element.querySelectorAll("li[data-date]"),this.viewMode){case"h":this.registerHoursView();break;case"w":this.registerWeeksView();break;case"m":this.registerMonthsView();break;case"y":this.registerYearsView();break}let a=this.element.querySelector("button.today > svg > text");a instanceof SVGTextElement&&(a.textContent=String(new Date().getDate())),this.sheetBounds=this.getSheetBounds(),this.markSelectedDates()}registerHoursView(){var n;if(this.interval){let r=`repeat(${Math.min(60/this.interval,6)}, 1fr)`;this.element.querySelectorAll(".sheet-body ul.minutes").forEach(l=>{l.style.gridTemplateColumns=r})}this.calendarItems.forEach(i=>{let r=this.getDate(i);(this.minDate&&r<this.minDate||this.maxDate&&r>this.maxDate)&&i.toggleAttribute("disabled",!0),i.hasAttribute("disabled")||(i.addEventListener("click",l=>{l.target instanceof HTMLLIElement&&(this.setDate(l.target),this.markSelectedDates(),(!this.settings.withRange||this.dateRange[0]&&this.dateRange[1])&&this.settings.close())},{once:!0}),this.settings.withRange&&i.addEventListener("mouseenter",this.handleOver))});let t=this.dateRange[0]?this.asUTCDate(this.dateRange[0]).toISOString().slice(0,13):"",e=this.settings.withRange&&this.dateRange[1]?this.asUTCDate(this.dateRange[1]).toISOString().slice(0,16):"",a=e.slice(0,13),s=this.todayDateString.slice(0,13).concat(":00");this.element.querySelectorAll("li[aria-label]").forEach(i=>{var m;let r=i.getAttribute("aria-label");i.classList.toggle("today",r===s);let l=`ul[aria-labelledby="${r}"]`;(t===r.slice(0,13)||a===r.slice(0,13)&&e.slice(11,16)!=="00:00")&&(i.classList.add("constricted"),(m=this.element.querySelector(l))==null||m.removeAttribute("hidden")),this.element.querySelectorAll(`${l} > li[data-date]:not([disabled])`).length===0&&i.toggleAttribute("disabled",!0),i.hasAttribute("disabled")||(i.addEventListener("click",o=>{o.target instanceof HTMLLIElement&&this.selectHour(o.target)}),this.settings.withRange&&i.addEventListener("mouseenter",this.handleOver))}),(n=this.element.querySelector(".sheet-body ul.hours:last-child"))==null||n.setAttribute("hidden","")}registerWeeksView(){let t=this.todayDateString.slice(0,10);this.calendarItems.forEach(e=>{e.classList.toggle("today",e.getAttribute("data-date")===t);let a=this.getDate(e);(this.minWeekDate&&a<this.minWeekDate||this.maxWeekDate&&a>this.maxWeekDate)&&e.toggleAttribute("disabled",!0),e.hasAttribute("disabled")||(e.addEventListener("click",this.selectDay),this.settings.withRange&&e.addEventListener("mouseenter",this.handleOver))})}registerMonthsView(){let t=this.todayDateString.slice(0,7);this.calendarItems.forEach(e=>{var n;let a=this.getDate(e),s=(n=e.getAttribute("data-date"))==null?void 0:n.slice(0,7);e.classList.toggle("today",s===t),(this.minMonthDate&&a<this.minMonthDate||this.maxMonthDate&&a>this.maxMonthDate)&&e.toggleAttribute("disabled",!0),e.hasAttribute("disabled")||(e.addEventListener("click",this.selectMonth),this.settings.withRange&&e.addEventListener("mouseenter",this.handleOver))})}registerYearsView(){let t=this.todayDateString.slice(0,4);this.calendarItems.forEach(e=>{var n;let a=this.getDate(e),s=(n=e.getAttribute("data-date"))==null?void 0:n.slice(0,4);e.classList.toggle("today",s===t),(this.minYearDate&&a<this.minYearDate||this.maxYearDate&&a>this.maxYearDate)&&e.toggleAttribute("disabled",!0),e.hasAttribute("disabled")||(e.addEventListener("click",this.selectYear),this.settings.withRange&&e.addEventListener("mouseenter",this.handleOver))})}async navigate(t){let e=null,a=new Map([["y","m"],["m","w"],["w","h"]]);switch(t){case"ArrowUp":await this.goto(0);break;case"ArrowRight":await this.goto(1);break;case"ArrowDown":await this.goto(2);break;case"ArrowLeft":await this.goto(3);break;case"Escape":case"Tab":this.settings.close();break;case"PageUp":e=this.element.querySelector("button.prev"),e&&await this.fetchCalendar(this.getDate(e),this.viewMode);break;case"PageDown":e=this.element.querySelector("button.next"),e&&await this.fetchCalendar(this.getDate(e),this.viewMode);break;case"Enter":if(this.preselectedDate){let s=this.asUTCDate(this.preselectedDate).toISOString().slice(0,this.viewMode==="h"?16:10);e=this.element.querySelector(`.sheet-body li[data-date="${s}"]`)}else{let s=this.upperRange?this.dateRange[1]:this.dateRange[0],n=s?this.asUTCDate(s).toISOString().slice(0,this.viewMode==="h"?16:10):"";e=this.element.querySelector(`.sheet-body li[data-date="${n}"]`)}e&&(this.viewMode==="h"||this.viewMode==="w"&&this.settings.dateOnly?(this.preselectedDate=null,this.setDate(e),this.markSelectedDates(),this.upperRange||this.settings.close()):await this.fetchCalendar(this.getDate(e),a.get(this.viewMode)));break;default:break}return!0}getDelta(t,e){let a=this.interval,s=(a??60)<60?new Map([[0,-60],[1,+a],[2,60],[3,-a]]):new Map([[0,-360],[1,60],[2,360],[3,-60]]),n=new Map([[0,-10080],[1,1440],[2,10080],[3,-1440]]),i=new Date(e);switch(this.viewMode){case"h":return new Date(e.getTime()+6e4*s.get(t));case"w":return new Date(e.getTime()+6e4*n.get(t));case"m":switch(t){case 0:i.setMonth(i.getMonth()-3);break;case 1:i.setMonth(i.getMonth()+1);break;case 2:i.setMonth(i.getMonth()+3);break;case 3:i.setMonth(i.getMonth()-1);break}break;case"y":switch(t){case 0:i.setFullYear(e.getFullYear()-4);break;case 1:i.setFullYear(e.getFullYear()+1);break;case 2:i.setFullYear(e.getFullYear()+4);break;case 3:i.setFullYear(e.getFullYear()-1);break}break}return i}getDateSelector(t){let e=this.asUTCDate(t).toISOString(),a;switch(this.viewMode){case"h":a=e.slice(0,16);break;case"w":a=e.slice(0,10);break;case"m":a=`${e.slice(0,7)}-01`;break;case"y":a=`${e.slice(0,4)}-01-01`;break}return`li[data-date="${a}"]`}indexOfCalendarItem(t){let e=this.getDateSelector(t),a=this.element.querySelector(e);return Array.from(this.calendarItems).indexOf(a)}markDateRange(t,e,a=!1){var D,y;let s=t<e?t:e,n=t<e?e:t,i=this.indexOfCalendarItem(s),r=this.indexOfCalendarItem(n),l=a&&!((D=this.calendarItems.item(i))!=null&&D.classList.contains("selected"))?1:2,m=a&&!((y=this.calendarItems.item(r))!=null&&y.classList.contains("selected"))?1:0,o=this.interval?Math.min(60/this.interval,6):1,p=Math.floor(i/o)%6+1,w=Math.floor(r/o)%6+1,h;if(i===-1&&r===-1)s<this.sheetBounds[0]&&n>this.sheetBounds[1]?h=[":not(.weekdays) > li"]:h=[":not(*)"];else if(i===-1)if(this.viewMode==="h"){let d=Math.floor(r/6/o)+1;h=[`:nth-child(-n + ${d-1} of .hours) > li`,`:nth-child(${d} of .hours) > li:nth-child(-n + ${w-1})`]}else h=[`:not(.weekdays) > li:nth-child(-n + ${r+m})`];else if(r===-1)if(this.viewMode==="h"){let d=Math.floor(i/6/o)+1;h=[`:nth-child(${d} of .hours) > li:nth-child(n + ${p+1})`,`:nth-child(n + ${d+1} of .hours) > li`]}else h=[`:not(.weekdays) > li:nth-child(n + ${i+l})`];else if(this.viewMode==="h"){let d=Math.floor(i/6/o)+1,c=Math.floor(r/6/o)+1;d===c?h=[`:nth-child(${d} of .hours) > li:nth-child(n + ${p+1}):nth-child(-n + ${w-1})`]:h=[`:nth-child(${d} of .hours) > li:nth-child(n + ${p+1})`,`:nth-child(n + ${d+1} of .hours):nth-child(-n + ${c-1} of .hours) > li`,`:nth-child(${c} of .hours) > li:nth-child(-n + ${w-1})`]}else h=[`:not(.weekdays) > li:nth-child(n + ${i+l}):nth-child(-n + ${r+m})`];if(this.viewMode==="h"&&this.interval&&(i!==-1||r!==-1)){let d=Math.floor(i/o)+1,c=Math.floor(r/o)+1;r===-1?h.push(`:nth-child(${d} of .minutes) > li:nth-child(n + ${i%o+2})`):i===-1?h.push(`:nth-child(${c} of .minutes) > li:nth-child(-n + ${r%o})`):d===c?h.push(`:nth-child(${d} of .minutes) > li:nth-child(n + ${i%o+2}):nth-child(-n + ${r%o})`):(h.push(`:nth-child(${d} of .minutes) > li:nth-child(n + ${i%o+2})`),h.push(`:nth-child(${c} of .minutes) > li:nth-child(-n + ${r%o})`))}this.rangeSelectCssRule.selectorText=h.map(d=>this.rangeSelectorText.replace(":not(*)",d)).join(",")}markSelectedDates(){var t,e,a,s,n,i,r;if(this.calendarItems.forEach(l=>l.classList.remove("selected","preselected")),this.settings.withRange){if(this.dateRange[0]&&this.dateRange[1]){this.markDateRange(this.dateRange[0],this.dateRange[1]),(t=this.calendarItems.item(this.indexOfCalendarItem(this.dateRange[0])))==null||t.classList.add("selected");let l=this.indexOfCalendarItem(this.dateRange[1]);(l!==0||this.viewMode!=="h"||this.dateRange[1].getHours()!==0||this.dateRange[1].getMinutes()!==0)&&((e=this.calendarItems.item(l))==null||e.classList.add("selected"))}else if(this.dateRange[0]){let l=this.getDateSelector(this.dateRange[0]);(a=this.element.querySelector(l))==null||a.classList.add("selected")}if(this.preselectedDate){let l=this.getDateSelector(this.preselectedDate);(s=this.element.querySelector(l))==null||s.classList.add("preselected")}if(this.viewMode==="h"){let l=(n=this.element.querySelector(".sheet-body ul.hours:last-child > li"))==null?void 0:n.getAttribute("data-date");(i=this.element.querySelector(".sheet-body ul.hours:last-child"))==null||i.toggleAttribute("hidden",this.dateRange[1]?this.asUTCDate(this.dateRange[1]).toISOString().slice(0,16)!==l:!this.upperRange)}}else if(this.dateRange[0]){let l=this.getDateSelector(this.dateRange[0]);(r=this.element.querySelector(l))==null||r.classList.add("selected")}}setDate(t){let e=new Date(t.getAttribute("data-date"));this.settings.withRange?this.upperRange&&this.dateRange[0]?(this.dateRange=e<this.dateRange[0]?[e,this.dateRange[0]]:[this.dateRange[0],e],this.settings.updateDate(this.dateRange[0],this.dateRange[1]),this.upperRange=!1,this.rangeSelectCssRule.style.cursor=""):(this.dateRange=[e,null],this.settings.updateDate(e,null),this.upperRange=!0):(this.dateRange[0]=e,this.settings.updateDate(this.dateRange[0],!0)),this.minDate&&(this.dateRange[0]&&this.dateRange[0]<this.minDate&&(this.dateRange[0]=this.minDate),this.dateRange[1]&&this.dateRange[1]<this.minDate&&(this.dateRange[1]=this.minDate)),this.maxDate&&(this.dateRange[0]&&this.dateRange[0]>this.maxDate&&(this.dateRange[0]=this.maxDate),this.dateRange[1]&&this.dateRange[1]>this.maxDate&&(this.dateRange[1]=this.maxDate)),this.settings.withRange&&this.showDateRange()}showDateRange(){let t=(s,n)=>{s.dateTime=n.toISOString(),s.textContent=this.settings.dateOnly?n.toDateString():n.toLocaleString()},e=this.element.querySelector(".sheet-body > .aside-left > time");if(e){let s=this.element.querySelector("li[data-date]:first-child"),n=this.getDate(s);this.dateRange[1]&&this.dateRange[1]<n?t(e,this.dateRange[1]):this.dateRange[0]&&this.dateRange[0]<n?t(e,this.dateRange[0]):(e.dateTime="",e.textContent="")}let a=this.element.querySelector(".sheet-body > .aside-right > time");if(a){let s=this.element.querySelector("li[data-date]:last-child"),n=this.getDate(s);this.dateRange[0]&&this.dateRange[0]>n?t(a,this.dateRange[0]):this.dateRange[1]&&this.dateRange[1]>n?t(a,this.dateRange[1]):(a.dateTime="",a.textContent="")}}async selectToday(){let t=this.todayDateString.slice(0,10),e=this.element.querySelector(`li[data-date="${t}"]`);e||(await this.fetchCalendar(new Date,"w"),e=this.element.querySelector(`li[data-date="${t}"]`)),e&&!e.hasAttribute("disabled")&&(this.setDate(e),this.markSelectedDates()),(!this.settings.withRange||this.dateRange[0]&&this.dateRange[1])&&this.settings.close()}selectHour(t){var a;this.element.querySelectorAll("li[aria-label]").forEach(s=>{s.classList.remove("selected","preselected","constricted")}),this.element.querySelectorAll("ul[aria-labelledby]").forEach(s=>{s.toggleAttribute("hidden",!0)}),this.rangeSelectCssRule.selectorText=`${this.baseSelector} .sheet-body ul:not(*)`;let e=t.getAttribute("aria-label");if(e){let s=this.element.querySelector(`ul[aria-labelledby="${e}"]`);s instanceof HTMLUListElement&&(t.classList.add("constricted"),s.removeAttribute("hidden"))}else if(t.parentElement instanceof HTMLUListElement&&t.parentElement.hasAttribute("aria-labelledby")){let s=t.parentElement.getAttribute("aria-labelledby");(a=this.element.querySelector(`li[aria-label="${s}"]`))==null||a.classList.add("constricted"),t.parentElement.removeAttribute("hidden")}}async goto(t){let e=null;if(this.settings.withRange?this.preselectedDate?e=this.preselectedDate:!this.upperRange&&this.dateRange[0]?e=this.dateRange[0]:this.upperRange&&this.dateRange[1]&&(e=this.dateRange[1]):this.dateRange[0]&&(e=this.dateRange[0]),!e)if(this.dateRange[0])e=this.dateRange[0];else{let i=this.calendarItems.item(this.calendarItems.length/2);e=this.getDate(i)}let a=this.getDelta(t,e);this.preselectedDate=this.settings.withRange?a:null;let s=this.asUTCDate(a).toISOString().slice(0,this.viewMode==="h"?16:10),n=null;(this.viewMode!=="w"||e.getMonth()===a.getMonth())&&(n=this.element.querySelector(`.sheet-body li[data-date="${s}"]`)),n||(await this.fetchCalendar(a,this.viewMode),n=this.element.querySelector(`.sheet-body li[data-date="${s}"]`)),n instanceof HTMLLIElement&&(this.viewMode==="h"&&this.selectHour(n),this.preselectedDate||this.setDate(n),this.markSelectedDates(),this.upperRange&&this.dateRange[0]&&this.preselectedDate&&this.markDateRange(this.dateRange[0],this.preselectedDate,!0))}async fetchCalendar(t,e){let a=new URLSearchParams("calendar");a.set("date",this.asUTCDate(t).toISOString().slice(0,10)),a.set("mode",e),this.settings.hour12&&a.set("hour12",""),this.settings.pure&&a.set("pure",""),this.interval&&a.set("interval",String(this.interval));let s=await fetch(`${this.endpoint}?${a.toString()}`,{method:"GET"});s.status===200?(this.element.innerHTML=await s.text(),this.settings.withRange&&this.showDateRange()):console.error(`Failed to fetch from ${this.endpoint} (status=${s.status})`)}getSheetBounds(){let t=this.calendarItems.item(0),e=this.calendarItems.item(this.calendarItems.length-1),a=new Date(t.getAttribute("data-date")),s=new Date(e.getAttribute("data-date"));return[a,s]}transferStyles(){let t=document.createElement("style");if(t.innerText=S,document.head.appendChild(t),!t.sheet)throw new Error("Could not create <style> element");let e=t.sheet,a=!1,s=this.settings.inputElement;s.style.transition="none";for(let n=0;n<e.cssRules.length;n++){let i=e.cssRules.item(n),r;switch(i.selectorText){case this.baseSelector:r=u.extractStyles(s,["background-color","border","border-radius","font-family","font-size","font-stretch","font-style","font-weight","letter-spacing","white-space","line-height"]),e.insertRule(`${i.selectorText}{${r}}`,++n),a=!0;break;case`${this.baseSelector} .controls`:r=u.extractStyles(s,["padding"]),e.insertRule(`${i.selectorText}{${r}}`,++n);break;case`${this.baseSelector} .sheet-body .central`:r=u.extractStyles(s,["padding"]),e.insertRule(`${i.selectorText}{${r}}`,++n);break;case`${this.baseSelector} .sheet-body ul.hours > li.constricted`:case`${this.baseSelector} .sheet-body ul.hours > li:has(~ li.constricted)`:case`${this.baseSelector} .sheet-body ul.hours > li.constricted ~ li`:case`${this.baseSelector} .sheet-body ul.minutes`:s.classList.add("-focus-"),r=u.extractStyles(s,["border-color"]),e.insertRule(`${i.selectorText}{${r}}`,++n),s.classList.remove("-focus-"),i.selectorText===`${this.baseSelector} .sheet-body ul.hours > li.constricted`&&(r=u.extractStyles(this.element,["background-color"]),r=r.replace("background-color","border-bottom-color"),e.insertRule(`${i.selectorText}{${r}}`,++n));break;default:break}}if(s.style.transition="",!a)throw new Error(`Could not load styles for ${this.baseSelector}`)}getRangeSelectCssRule(){for(let t=document.styleSheets.length-1;t>=0;--t){let e=document.styleSheets[t];for(let a=0;a<e.cssRules.length;++a){let s=e.cssRules[a];if(s instanceof CSSStyleRule&&s.selectorText===`${this.baseSelector} .sheet-body ul:not(*)`){let n=`#${this.settings.inputElement.id} ~ ${this.baseSelector} .sheet-body ul:not(*)`,i=e.insertRule(`${n}{${s.style.cssText}}`,e.cssRules.length);return e.cssRules[i]}}}throw new Error(`Could not find CSS rule for '${this.baseSelector} .sheet-body ul:not(*)'`)}formResetted(t){this.settings.inputElement.value=this.settings.inputElement.defaultValue,this.settings.inputElement.value?this.updateDate(new Date(this.settings.inputElement.value),null):this.updateDate(null,null)}formSubmitted(t){}updateDate(t,e){this.dateRange=t?[t,e]:[null,null],this.upperRange=!1,t&&this.fetchCalendar(t,this.viewMode)}valueAsDate(){return this.dateRange[0]}},g=Symbol("Calendar"),x=class extends HTMLInputElement{connectedCallback(){let f=this.closest('[role="group"]');if(!f)throw new Error(`Attempt to initialize ${this} outside <django-formset>`);let t=f.querySelector('[aria-label="calendar"]'),e=["django-datecalendar","django-datepicker","django-daterangecalendar","django-daterangepicker"].includes(this.getAttribute("is")??""),a=["django-daterangecalendar","django-daterangepicker","django-datetimerangecalendar","django-datetimerangepicker"].includes(this.getAttribute("is")??""),s=Intl.DateTimeFormat(navigator.language,{hour:"2-digit"}),n={dateOnly:e,withRange:a,inputElement:this,hour12:s.resolvedOptions().hour12??!1,pure:!0,updateDate:()=>{},close:()=>{}};if(a?n.updateDate=(i,r)=>{let l=[i.toISOString().slice(0,e?10:16),(r==null?void 0:r.toISOString().slice(0,e?10:16))??""];this.value=l.join(";"),this.dispatchEvent(new Event("input")),this.dispatchEvent(new Event("blur"))}:n.updateDate=i=>{this.value=i.toISOString().slice(0,e?10:16),this.dispatchEvent(new Event("input")),this.dispatchEvent(new Event("blur"))},this[g]=new b(t,n),this.value)if(a){let[i,r]=this.value.split(";");this[g].updateDate(new Date(i),new Date(r))}else this[g].updateDate(new Date(this.value),null);n.pure||document.addEventListener("keydown",async i=>{(await this[g].navigate(i.key)??!1)&&i.preventDefault()}),this.hidden=!0}get valueAsDate(){return this[g].valueAsDate()}};g;export{b as a,x as b};
