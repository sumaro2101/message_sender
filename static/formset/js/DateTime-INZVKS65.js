import{a as v}from"./chunk-YSH5AIQC.js";import{b as m}from"./chunk-W5RPWA2M.js";import{a as x,c as f,d as g,e as y}from"./chunk-RLE6ONWJ.js";import{a as c}from"./chunk-65OJRBX6.js";import"./chunk-P2VM2T3G.js";var E='[is^=django-date]{--dummy-style: none}[is^=django-date]+[role=textbox]{position:relative}[is^=django-date]+[role=textbox].focus{--dummy-style: none}[is^=django-date]+[role=textbox]>.calendar-picker-indicator{display:flex;align-items:center;position:absolute;top:0;left:.5rem;bottom:0;cursor:pointer}[is^=django-date]+[role=textbox]>.calendar-picker-indicator svg{scale:.75}[is^=django-date]+[role=textbox]>.datetime-edit{display:flex;overflow-x:hidden}[is^=django-date]+[role=textbox]>.datetime-edit>.datetime-delimiter{color:#606060;margin:0 -1px}[is^=django-date]+[role=textbox]>.datetime-edit>.datetime-delimiter.wide{margin:0;padding:0 .125rem}[is^=django-date]+[role=textbox]>.datetime-edit>.datetime-edit-year-field,[is^=django-date]+[role=textbox]>.datetime-edit>.datetime-edit-month-field,[is^=django-date]+[role=textbox]>.datetime-edit>.datetime-edit-day-field,[is^=django-date]+[role=textbox]>.datetime-edit>.datetime-edit-hour-field,[is^=django-date]+[role=textbox]>.datetime-edit>.datetime-edit-minute-field{padding:.125rem;cursor:text;caret-color:rgba(0,0,0,0)}[is^=django-date]+[role=textbox]>.datetime-edit>.datetime-edit-year-field:focus-visible,[is^=django-date]+[role=textbox]>.datetime-edit>.datetime-edit-month-field:focus-visible,[is^=django-date]+[role=textbox]>.datetime-edit>.datetime-edit-day-field:focus-visible,[is^=django-date]+[role=textbox]>.datetime-edit>.datetime-edit-hour-field:focus-visible,[is^=django-date]+[role=textbox]>.datetime-edit>.datetime-edit-minute-field:focus-visible{border-radius:3px;outline:none;background-color:#0d6efd;color:#fff}[is^=django-date]+[role=textbox]>.datetime-edit>.datetime-edit-year-field:empty::after{content:"yyyy";color:#d3d3d3}[is^=django-date]+[role=textbox]>.datetime-edit>.datetime-edit-month-field:empty::after{content:"mm";color:#d3d3d3}[is^=django-date]+[role=textbox]>.datetime-edit>.datetime-edit-day-field:empty::after{content:"dd";color:#d3d3d3}[is^=django-date]+[role=textbox]>.datetime-edit>.datetime-edit-hour-field:empty::after{content:"HH";color:#d3d3d3}[is^=django-date]+[role=textbox]>.datetime-edit>.datetime-edit-minute-field:empty::after{content:"MM";color:#d3d3d3}:is([is=django-datepicker],[is=django-datetimepicker],[is=django-daterangepicker],[is=django-datetimerangepicker])+[role=textbox]>.datetime-edit{margin-left:calc(1rem + .6em)}';var F=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
	<path d="M17 3H21C21.5523 3 22 3.44772 22 4V20C22 20.5523 21.5523 21 21 21H3C2.44772 21 2 20.5523 2 20V4C2 3.44772 2.44772 3 3 3H7V1H9V3H15V1H17V3ZM4 9V19H20V9H4ZM6 11H8V13H6V11ZM11 11H13V13H11V11ZM16 11H18V13H16V11Z"></path>
</svg>`;var d=class extends m{constructor(e,t){super(e);this.calendar=null;this.inputFields=[];this.inputFieldsOrder=[];this.baseSelector='[is^="django-date"]';this.hour12=!1;this.currentDate=null;this.extendedDate=null;this.calendarOpener=null;this.hasFocus=null;this.isOpen=!1;this.handleClick=e=>{if(!this.calendar)return;let t=e.target instanceof Element?e.target:null;for(;t;){if(t===this.calendar.element)return;if(t===this.calendarOpener)return this.isOpen?this.closeCalendar():this.openCalendar();t=t.parentElement}this.closeCalendar()};this.updatePosition=()=>{if(!this.calendar)return;let e=this.textBox.style.zIndex?parseInt(this.textBox.style.zIndex):0;y(this.textBox,this.calendar.element,{middleware:[g(),f()]}).then(({y:t})=>Object.assign(this.calendar.element.style,{top:`${t}px`,zIndex:`${e+1}`}))};this.handleFocus=e=>{this.inputFields.some(t=>{if(e.target instanceof HTMLElement&&t===e.target)return t.ariaBusy="true",this.hasFocus=t,!0})?(this.textBox.classList.add("focus"),this.inputElement.dispatchEvent(new Event("focus")),e.preventDefault()):this.hasFocus=null};this.handleBlur=()=>{setTimeout(()=>{var e;this.hasFocus||(this.textBox.classList.remove("focus"),this.parseInputFields(),this.updateInputFields(),(e=this.calendar)==null||e.updateDate(this.currentDate,this.extendedDate),this.inputElement.dispatchEvent(new Event("blur")))},0),this.hasFocus=null,this.inputElement.dispatchEvent(new Event("input"))};this.handleKeypress=async e=>{var i;let t=!1;this.hasFocus?t=this.editTextBox(e.key):this.isOpen&&(t=await((i=this.calendar)==null?void 0:i.navigate(e.key))??!1),t&&e.preventDefault()};if(this.inputElement=e,this.dateOnly=["django-datefield","django-datepicker","django-daterangefield","django-daterangepicker"].includes(e.getAttribute("is")??""),this.withRange=["django-daterangefield","django-daterangepicker","django-datetimerangefield","django-datetimerangepicker"].includes(e.getAttribute("is")??""),this.textBox=this.createTextBox(),this.setInitialDate(),t){this.calendar=new v(t,this.getCalendarSettings());let i=this.textBox.querySelector(".calendar-picker-indicator");if(!(i instanceof HTMLElement))throw new Error("Missing selector .calendar-picker-indicator");this.calendarOpener=i,this.calendarOpener.innerHTML=F}this.installEventHandlers(),c.stylesAreInstalled(this.baseSelector)||this.transferStyles(),this.transferClasses(),this.updateInputFields()}setInitialDate(){let e=this.inputElement.value;if(e)if(this.withRange){let[t,i]=e.split(";");this.currentDate=t?new Date(t):null,this.extendedDate=i?new Date(i):null}else this.currentDate=new Date(e),this.extendedDate=null;else this.currentDate=this.extendedDate=null}updateDate(e,t){this.withRange&&t instanceof Date?(this.currentDate=e,this.extendedDate=t):this.currentDate=e,this.updateInputFields(),t&&(this.inputElement.dispatchEvent(new Event("input")),this.inputElement.dispatchEvent(new Event("blur")))}getCalendarSettings(){return{dateOnly:this.dateOnly,withRange:this.withRange,pure:!1,inputElement:this.inputElement,hour12:this.hour12,updateDate:(t,i)=>this.updateDate(t,i),close:()=>this.closeCalendar()}}createTextBox(){let e=['<div role="textbox" aria-expanded="false" aria-haspopup="dialog">','<div class="datetime-edit">'],t=['<span role="spinbutton" class="datetime-edit-year-field" contenteditable="true" aria-placeholder="yyyy" aria-valuemin="1700" aria-valuemax="2300"></span>','<span role="separator" class="datetime-delimiter" aria-hidden="true">-</span>','<span role="spinbutton" class="datetime-edit-month-field" contenteditable="true" aria-placeholder="mm" aria-valuemin="1" aria-valuemax="12"></span>','<span role="separator" class="datetime-delimiter" aria-hidden="true">-</span>','<span role="spinbutton" class="datetime-edit-day-field" contenteditable="true" aria-placeholder="dd" aria-valuemin="1" aria-valuemax="31"></span>'];return this.dateOnly||(t.push('<span role="separator" class="datetime-delimiter wide" aria-hidden="true"> </span>'),t.push('<span role="spinbutton" class="datetime-edit-hour-field" contenteditable="true" aria-placeholder="hh" aria-valuemin="0" aria-valuemax="23"></span>'),t.push('<span role="separator" class="datetime-delimiter" aria-hidden="true">:</span>'),t.push('<span role="spinbutton" class="datetime-edit-minute-field" contenteditable="true" aria-placeholder="mm" aria-valuemin="0" aria-valuemax="59"></span>')),this.inputElement.getAttribute("date-format")==="iso"?(e.push(...t),this.inputFieldsOrder.push(0,1,2)):(this.dateTimeFormat=Intl.DateTimeFormat(navigator.language,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",calendar:"iso8601"}),this.hour12=this.dateTimeFormat.resolvedOptions().hour12??!1,this.dateTimeFormat.formatToParts().forEach(i=>{switch(i.type){case"year":e.push(t[0]),this.inputFieldsOrder.push(0);break;case"month":e.push(t[2]),this.inputFieldsOrder.push(1);break;case"day":e.push(t[4]),this.inputFieldsOrder.push(2);break;case"literal":[".","/","-"].includes(i.value)&&e.push(`<span role="separator" class="datetime-delimiter" aria-hidden="true">${i.value}</span>`),this.dateOnly||([", "," "].includes(i.value)&&e.push(t[5]),[":"].includes(i.value)&&e.push(t[7]));break;case"hour":this.dateOnly||(e.push(t[6]),this.inputFieldsOrder.push(3));break;case"minute":this.dateOnly||(e.push(t[8]),this.inputFieldsOrder.push(4));break;default:break}})),this.withRange&&(e.push('<span role="separator" class="datetime-delimiter wide" aria-hidden="true">\u2013</span>'),e.push(...e.slice(2,-1)),this.inputFieldsOrder.push(...this.inputFieldsOrder.map(i=>i+5))),e.push("</div>"),e.push('<span class="calendar-picker-indicator"></span>'),e.push("</div>"),this.inputElement.insertAdjacentHTML("afterend",e.join("")),this.inputElement.nextElementSibling}installEventHandlers(){this.inputFields[0]=this.textBox.querySelector(".datetime-edit-year-field"),this.inputFields[1]=this.textBox.querySelector(".datetime-edit-month-field"),this.inputFields[2]=this.textBox.querySelector(".datetime-edit-day-field"),this.dateOnly||(this.inputFields[3]=this.textBox.querySelector(".datetime-edit-hour-field"),this.inputFields[4]=this.textBox.querySelector(".datetime-edit-minute-field")),this.withRange&&(this.inputFields[5]=this.textBox.querySelector(".datetime-edit-year-field ~ .datetime-edit-year-field"),this.inputFields[6]=this.textBox.querySelector(".datetime-edit-month-field ~ .datetime-edit-month-field"),this.inputFields[7]=this.textBox.querySelector(".datetime-edit-day-field ~ .datetime-edit-day-field"),this.dateOnly||(this.inputFields[8]=this.textBox.querySelector(".datetime-edit-hour-field ~ .datetime-edit-hour-field"),this.inputFields[9]=this.textBox.querySelector(".datetime-edit-minute-field ~ .datetime-edit-minute-field"))),this.inputFields.forEach(e=>{e.addEventListener("focus",this.handleFocus),e.addEventListener("blur",this.handleBlur)}),document.addEventListener("click",this.handleClick),document.addEventListener("keydown",this.handleKeypress)}openCalendar(){this.calendarOpener&&(this.calendar.element.parentElement.style.position="relative",this.cleanup=x(this.textBox,this.calendar.element,this.updatePosition),this.textBox.setAttribute("aria-expanded","true"),this.isOpen=!0,this.calendar.updateDate(this.currentDate,this.extendedDate))}closeCalendar(){var e;this.isOpen=!1,this.textBox.setAttribute("aria-expanded","false"),(e=this.cleanup)==null||e.call(this)}updateInputFields(){let e=(t,i,r,n,u,h)=>{this.inputFields[i].innerText=String(t.getFullYear()),this.inputFields[r].innerText=String(t.getMonth()+1).padStart(2,"0"),this.inputFields[n].innerText=String(t.getDate()).padStart(2,"0"),this.dateOnly||(this.inputFields[u].innerText=String(t.getHours()).padStart(2,"0"),this.inputFields[h].innerText=String(t.getMinutes()).padStart(2,"0"))};this.currentDate?(e(this.currentDate,0,1,2,3,4),this.inputElement.value=this.currentDate.toISOString().slice(0,this.dateOnly?10:16),this.extendedDate&&(e(this.extendedDate,5,6,7,8,9),this.inputElement.value=[this.inputElement.value,this.extendedDate.toISOString().slice(0,this.dateOnly?10:16)].join(";"))):(this.inputFields.forEach(t=>t.innerText=""),this.inputElement.value="")}parseInputFields(){let e=(r,n,u,h,l)=>{let p=[Math.min(Math.max(parseInt(this.inputFields[r].innerText),1700),2300).toString(),"-",Math.min(Math.max(parseInt(this.inputFields[n].innerText),1),12).toString().padStart(2,"0"),"-",Math.min(Math.max(parseInt(this.inputFields[u].innerText),1),31).toString().padStart(2,"0")];return this.dateOnly||(p.push("T"),p.push(Math.min(Math.max(parseInt(this.inputFields[h].innerText),0),23).toString().padStart(2,"0")),p.push(":"),p.push(Math.min(Math.max(parseInt(this.inputFields[l].innerText),0),59).toString().padStart(2,"0"))),p},t=e(0,1,2,3,4),i=new Date(t.join(""));if(i&&!isNaN(i.getTime())){if(this.currentDate=i,this.withRange){let r=e(5,6,7,8,9),n=new Date(r.join(""));n&&!isNaN(n.getTime())?this.extendedDate=n:this.extendedDate=null}}else this.currentDate=this.extendedDate=null}editTextBox(e){var i,r,n,u;let t=this.hasFocus;switch(e){case"ArrowRight":return(i=this.nextInputField)==null||i.focus(),!0;case"ArrowLeft":return(r=this.previousInputField)==null||r.focus(),!0;case"ArrowUp":if(t.innerText){let l=parseInt(t.ariaValueMax??"0");l=Math.min(l,parseInt(t.innerText)+1),t.innerText=l.toString().padStart(2,"0")}else this.inputFields.indexOf(t)<5?this.currentDate=new Date:this.withRange&&(this.currentDate=this.currentDate??new Date,this.extendedDate=new Date),this.updateInputFields();return!0;case"ArrowDown":if(t.innerText){let l=parseInt(t.ariaValueMin??"0");l=Math.max(l,parseInt(t.innerText)-1),t.innerText=l.toString().padStart(2,"0")}else this.inputFields.indexOf(t)<5?this.currentDate=new Date:this.withRange&&(this.currentDate=this.currentDate??new Date,this.extendedDate=new Date),this.updateInputFields();return!0;case"Backspace":case"Delete":return t.ariaBusy==="true"?(t.innerText="",t.ariaBusy="false",!0):!1;case"-":case"/":case".":case":":case" ":return t.ariaBusy==="false"&&((n=this.nextInputField)==null||n.focus()),!0;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":t.ariaBusy==="true"&&(t.innerText="",t.ariaBusy="false");let h=((u=t.ariaPlaceholder)==null?void 0:u.length)??0;return t.innerText.length===h-1&&setTimeout(()=>{var l;return(l=this.nextInputField)==null?void 0:l.focus()},0),t.innerText.length===h;default:return!0}}get previousInputField(){let e=this.hasFocus,t=this.inputFieldsOrder.indexOf(this.inputFields.indexOf(e));if(t>0)return this.inputFields[this.inputFieldsOrder[t-1]]}get nextInputField(){let e=this.hasFocus,t=this.inputFieldsOrder.indexOf(this.inputFields.indexOf(e));if(t<this.inputFieldsOrder.length-1)return this.inputFields[this.inputFieldsOrder[t+1]]}transferStyles(){let e=document.createElement("style");e.innerText=E,document.head.appendChild(e),this.inputElement.style.transition="none";let t=!1;for(let i=0;e.sheet&&i<e.sheet.cssRules.length;i++){let r=e.sheet.cssRules.item(i),n;switch(r.selectorText){case this.baseSelector:t=!0;break;case`${this.baseSelector} + [role="textbox"]`:n=c.extractStyles(this.inputElement,["background-color","border","color","outline","height","line-height","padding"]),e.sheet.insertRule(`${r.selectorText}{${n}}`,++i);break;case`${this.baseSelector} + [role="textbox"].focus`:this.inputElement.classList.add("-focus-"),n=c.extractStyles(this.inputElement,["background-color","border","box-shadow","color","outline","transition"]),this.inputElement.classList.remove("-focus-"),e.sheet.insertRule(`${r.selectorText}{${n}}`,++i);break;default:break}}if(this.inputElement.style.transition="",!t)throw new Error(`Could not load styles for ${this.baseSelector}`)}transferClasses(){this.inputElement.classList.forEach(e=>{this.textBox.classList.add(e)}),this.inputElement.classList.remove(...this.inputElement.classList),this.inputElement.style.transition="",this.inputElement.hidden=!0}formResetted(e){this.inputElement.value=this.inputElement.defaultValue,this.setInitialDate(),this.updateInputFields()}formSubmitted(e){}valueAsDate(){return this.currentDate}checkValidity(){if(this.withRange&&this.currentDate&&this.extendedDate&&this.currentDate>this.extendedDate){let e=this.errorMessages.get("customError")??"Start date must be before end date";return this.inputElement.setCustomValidity(e),!1}return!0}},a=Symbol("DateTime"),b=class extends HTMLInputElement{constructor(){if(super(),!this.closest('[role="group"]'))throw new Error(`Attempt to initialize ${this} outside <django-formset>`);this[a]=new d(this,null)}get valueAsDate(){return this[a].valueAsDate()}};a;var D=class extends HTMLInputElement{constructor(){super();let s=this.closest('[role="group"]');if(!s)throw new Error(`Attempt to initialize ${this} outside <django-formset>`);let e=s.querySelector('[aria-label="calendar"]');this[a]=new d(this,e)}get valueAsDate(){return this[a].valueAsDate()}};a;var w=class extends HTMLInputElement{constructor(){if(super(),!this.closest('[role="group"]'))throw new Error(`Attempt to initialize ${this} outside <django-formset>`);this[a]=new d(this,null)}get valueAsDate(){return this[a].valueAsDate()}};a;var T=class extends HTMLInputElement{constructor(){super();let s=this.closest('[role="group"]');if(!s)throw new Error(`Attempt to initialize ${this} outside <django-formset>`);let e=s.querySelector('[aria-label="calendar"]');this[a]=new d(this,e)}get valueAsDate(){return this[a].valueAsDate()}};a;var S=class extends HTMLInputElement{constructor(){if(super(),!this.closest('[role="group"]'))throw new Error(`Attempt to initialize ${this} outside <django-formset>`);this[a]=new d(this,null)}checkValidity(){return super.checkValidity()?this[a].checkValidity():!1}};a;var M=class extends HTMLInputElement{constructor(){super();let s=this.closest('[role="group"]');if(!s)throw new Error(`Attempt to initialize ${this} outside <django-formset>`);let e=s.querySelector('[aria-label="calendar"]');this[a]=new d(this,e)}checkValidity(){return super.checkValidity()?this[a].checkValidity():!1}};a;var j=class extends HTMLInputElement{constructor(){if(super(),!this.closest('[role="group"]'))throw new Error(`Attempt to initialize ${this} outside <django-formset>`);this[a]=new d(this,null)}checkValidity(){return super.checkValidity()?this[a].checkValidity():!1}};a;var I=class extends HTMLInputElement{constructor(){super();let s=this.closest('[role="group"]');if(!s)throw new Error(`Attempt to initialize ${this} outside <django-formset>`);let e=s.querySelector('[aria-label="calendar"]');this[a]=new d(this,e)}checkValidity(){return super.checkValidity()?this[a].checkValidity():!1}};a;export{b as DateFieldElement,D as DatePickerElement,S as DateRangeFieldElement,M as DateRangePickerElement,w as DateTimeFieldElement,T as DateTimePickerElement,j as DateTimeRangeFieldElement,I as DateTimeRangePickerElement};
